#UNIT 6 HW
#KARAN KANT
library(tidyverse)
library(readr)
pressure$temp=c(273,283,293,303,313,323,333,343,353,363,373)
pressure$press=c(4.6,9.2,17.5,31.8,55.3,92.5,149.4,233.7,355.1,525.8,760)
pressure=data.frame()
pressure$temp=c(273,283,293,303,313,323,333,343,353,363,373)
pressure$press=c(4.6,9.2,17.5,31.8,55.3,92.5,149.4,233.7,355.1,525.8,760)
help("data.frame")
pressure$temp=c(273,283,293,303,313,323,333,343,353,363,373)
View(pressure)
View(pressure)
temp=c(273,283,293,303,313,323,333,343,353,363,373)
press=c(4.6,9.2,17.5,31.8,55.3,92.5,149.4,233.7,355.1,525.8,760)
pressure=cbind(temp,press)
pressure
pressure$temp
pressure=data.frame(pressure)
pressure
plot(pressure$press,pressure$temp)
pressure.lm=lm(press~temp,data=pressure)
summary(pressure.lm)
#PROBLEM 5.2A---------------PROBLEM 5.2A
#ANSWER: It is not linear
plot(pressure$temp,pressure$press)
pressure.lm=lm(press~temp,data=pressure)
summary(pressure.lm)
pressure.lm=lm(temp~press,data=pressure)
summary(pressure.lm)
rstandard.football<-rstandard(pressure.lm)
rstudent.football<-rstudent(pressure.lm)
x<-seq(1:11)
plot(pressure$temp,rstudent.football)
y.hat<-fitted(pressure.lm)
y.hat
plot(y.hat, rstudent.football, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
#PROBLEM 5.2A---------------PROBLEM 5.2A
#ANSWER: It is not linear
plot(pressure$temp,pressure$press)
pressure.lm=lm(press~temp,data=pressure)
y.hat<-fitted(pressure.lm)
summary(pressure.lm)
rstudent.football<-rstudent(pressure.lm)
plot(y.hat, rstudent.football, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
pressure$transpress<--1/pressure$press
View(pressure)
pressure$transpress<--1/pressure$press
pressuretrans.lm=lm(transpress~temp,data=pressure)
y.hat<-fitted(pressure.lm)
summary(pressure.lm)
pressure$transpress<--1/pressure$press
pressuretrans.lm=lm(transpress~temp,data=pressure)
y.hat<-fitted(pressuretrans.lm)
summary(pressuretrans.lm)
rstudent.football<-rstudent(pressure.lm)
plot(y.hat, rstudent.football, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
abline(h=0, lty=1, lwd=3)
rstudent.football<-rstudent(pressuretrans.lm)
plot(y.hat, rstudent.football, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
abline(h=0, lty=1, lwd=3)
pressure$transpress<-ln(pressure$press)
pressure$transpress<-log(pressure$press)
pressure$transtemp<--1/pressure$temp
plot(pressure$transtemp,pressure$transpress)
pressuretrans.lm=lm(transpress~transtemp,data=pressure)
y.hat<-fitted(pressuretrans.lm)
summary(pressuretrans.lm)
rstudent.football<-rstudent(pressuretrans.lm)
plot(y.hat, rstudent.football, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
abline(h=0, lty=1, lwd=3)
rstudent.football<-rstudent(pressuretrans.lm)
y.hat<-fitted(pressuretrans.lm)
summary(pressuretrans.lm)
rstudent.football<-rstudent(pressuretrans.lm)
plot(y.hat, rstudent.football, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
abline(h=0, lty=1, lwd=3)
#PROBLEM 5.2B-----------PROBLEM 5.2B
#ANSWER: There is a pattern in the residuals and it is not linear.
pressure.lm=lm(press~temp,data=pressure)
y.hat<-fitted(pressure.lm)
summary(pressure.lm)
rstudent.football<-rstudent(pressure.lm)
plot(y.hat, rstudent.football, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
abline(h=0, lty=1, lwd=3)
pressure$transpress<-log(pressure$press)
pressure$transtemp<--1/pressure$temp
plot(pressure$transtemp,pressure$transpress)
pressuretrans.lm=lm(transpress~transtemp,data=pressure)
y.hat<-fitted(pressuretrans.lm)
summary(pressuretrans.lm)
rstudent.football<-rstudent(pressuretrans.lm)
plot(y.hat, rstudent.football, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
abline(h=0, lty=1, lwd=3)
y.hat
energy.data <- read.table(file = "data/energy.txt")
defects<-c(13,16.1,14.5,17.8,22,27.4,16.8)
weeks<-c<4,5,6,7,8,9,10)
defects10<-(34.2,65.6,49.2,66.2,81.2,87.4,114.5)
defects<-c(13,16.1,14.5,17.8,22,27.4,16.8)
weeks<-c<(4,5,6,7,8,9,10)
defects10<-(34.2,65.6,49.2,66.2,81.2,87.4,114.5)
defects<-c(13,16.1,14.5,17.8,22,27.4,16.8)
weeks<-c(4,5,6,7,8,9,10)
defects10<-(34.2,65.6,49.2,66.2,81.2,87.4,114.5)
weeks<-(11,12,13,14,15,16,17)
defects<-c(13,16.1,14.5,17.8,22,27.4,16.8)
weeks<-c(4,5,6,7,8,9,10)
defects10<-c(34.2,65.6,49.2,66.2,81.2,87.4,114.5)
weeks<-c(11,12,13,14,15,16,17)
defects<-c(13,16.1,14.5,17.8,22,27.4,16.8)
weeks<-c(4,5,6,7,8,9,10)
defects10<-c(34.2,65.6,49.2,66.2,81.2,87.4,114.5)
weeks10<-c(11,12,13,14,15,16,17)
defects<-c(13,16.1,14.5,17.8,22,27.4,16.8,34.2,65.6,49.2,66.2,81.2,87.4,114.5)
weeks<-c(4,5,6,7,8,9,10,11,12,13,14,15,16,17)
bottle<-cbind(defects,weeks,defects10)
bottle<-data.frame(bottle)
plot(bottle$weeks,bottle$defects)
bottle.lm<-lm(bottle$defects~bottle$weeks)
summary(bottle.lm)
plot(y.hat, rstudent.bottle, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
summary(bottle.lm)
y.hat<-fitted(bottle.lm)
rstudent.bottle<-rstudent(bottle.lm)
plot(y.hat, rstudent.bottle, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
abline(h=0, lty=1, lwd=3)
bottle$transdefects<-log(bottle$defects)
plot(bottle$weeks,bottle$transdefects)
plot(bottle$weeks,bottle$defects)
plot(bottle$weeks,bottle$transdefects)
bottle$transdefects<-log(bottle$defects)
plot(bottle$weeks,bottle$transdefects)
bottletrans.lm<-lm(bottle$transdefects~bottle$weeks)
summary(bottletrans.lm)
y.hat<-fitted(bottletrans.lm)
rstudent.bottle<-rstudent(bottletrans.lm)
plot(y.hat, rstudent.bottle, pch=16, cex=1, xlab="fitted value", ylab="R-student residual", main = "Residual-by-fitted-value plot")
abline(h=0, lty=1, lwd=3)
plot(bottle$weeks,bottle$transdefects)
oxidation.data<-as.data.frame(table.b20)
oxidation.data<-as.data.frame(table.b20)
wine.data<-as.data.frame(table.b11)
library(MPV)
wine.data<-as.data.frame(table.b11)
oxidation.data<-as.data.frame(table.b20)
View(wine.data)
wine.lm<-lm(Quality~Clarity, Aroma, Body, Flavor, Oakiness)
wine.lm<-lm(Quality~Clarity, Aroma, Body, Flavor, Oakiness,data=wine.data)
wine.lm<-lm(Quality~Clarity, Aroma, Body, Flavor, Oakiness,data=wine.data)
wine.data$Flavor
wine.lm<-lm(Quality~Clarity, Aroma, Body, Oakiness,data=wine.data)
wine.lm<-lm(wine.data$Quality~wine.data$Clarity, wine.data$Aroma, wine.data$Body, wine.data$Flavor, wine.data$Oakiness,data=wine.data)
wine.lm<-lm(wine.data$Quality~wine.data$Clarity, wine.data$Aroma, wine.data$Body, wine.data$Flavor, wine.data$Oakiness)
wine.data<-as.data.frame(table.b11)
wine.lm<-lm(wine.data$Quality~wine.data$Clarity, wine.data$Aroma, wine.data$Body, wine.data$Flavor, wine.data$Oakiness)
wine.lm<-lm(Quality~Clarity+ Aroma+Body+Flavor+Oakiness,data=wine.data)
influence.measures(wine.lm)
gear.data<-as.data.frame(table.b12)
View(gear.data)
gear.lm<-lm(temp~soaktime+soakpct+difftime+diffpct+pitch,data=gear.data)
influence.measures(gear.lm)
gear.data<-as.data.frame(table.b14)
engine.data<-as.data.frame(table.b14)
View(gear.data)
View(engine.data)
engine.data<-as.data.frame(table.b14)
engine.lm<-lm(y~x1+x2+x3+x4+x5,data=engine.data)
influence.measures(engine.lm)
#PROBLEM 6.14-------------PROBLEM 6.14
#Observations 2,7 and 8 may be potentially influential with ihgh values
engine.data<-as.data.frame(table.b13)
View(engine.data)
engine.lm<-lm(y~x1+x2+x3+x4+x5+x6,data=engine.data)
influence.measures(engine.lm)
inverter.data<-as.data.frame(table.b14)
inverter.lm<-lm(y~x1+x2+x3+x4+x5,data=inverter.data)
influence.measures(inverter.lm)
library(tidyverse)
data<-read.table('data/delivery.txt')
setwd("C:/Users/karan/OneDrive/Documents/UVA/Fall Semester/STAT 6021/unit 06")
data<-read.table('data/delivery.txt')
View(data)
data.lm<-lm(V1~V2+V3, data=data)
R.stud.res <- rstudent(data.lm)
y.hat <- fitted(data.lm)
y.hat <- fitted(data.lm)
R.stud.res <- rstudent(data.lm)
h.val <- hatvalues(data.lm)
h.val
n <- dim(data)[[1]]
y.vect <- as.matrix(data[,1])
colnames(y.vect)[1] <- 'y'
X0.mat <- as.matrix(data[,2:3])
k <- dim(X0.mat)[[2]]
X.mat <- cbind(rep(x=1, times=n), X0.mat)
colnames(X.mat)[1] <- "intercept"
p <- dim(X.mat)[[2]]
XpX.mat <- t(X.mat) %*% X.mat
XpX.inv <- solve(XpX.mat)
Xpy.mat <- t(X.mat) %*% y.vect
b.hat <- XpX.inv %*% Xpy.mat
y.hat <- X.mat %*% b.hat
SS.Res <- as.numeric(t(y.vect) %*% y.vect) - as.numeric(t(y.hat) %*% y.vect)
df.Res <- n - p
MS.Res <- SS.Res / df.Res
b.hat
summary(data.lm)
p <- dim(X.mat)[[2]]
p
k
D.stat<-(R.stud.res)^2/p*(h.val/(1-h.val))
D.stat
delivery = read.table('data/delivery.txt')
delivery.lm = lm(V1 ~ V2+V3 data = delivery)
delivery.lm = lm(V1 ~ V2+V3, data = delivery)
r = rstandard(delivery.lm) ^ 2
p = length(delivery.lm$coefficients)
r = rstandard(delivery.lm) ^ 2
p = length(delivery.lm$coefficients)
h.diag = hatvalues(delivery.lm)
cooksdist = (r / p) * (h.diag / (1 - h))
cooksdist = (r / p) * (h.diag / (1 - h.diag))
cooksdist
t = rstudent(delivery.lm)
dffits = sqrt(h / (1 - h)) * t
t = rstudent(delivery.lm)
dffits = sqrt(h / (1 - h.diag)) * t
t = rstudent(delivery.lm)
dffits = sqrt(h.diag / (1 - h.diag)) * t
x.matrix = data.matrix(cbind('ones'= rep(1, nrow(delivery)), delivery[, -1]))
r.matrix = solve(t(x.matrix) %*% x.matrix) %*% t(x.matrix)
t = rstudent(delivery.lm)
dfbetas = matrix(NA, nrow = 25, ncol = 3)
for(i in 1:25){
for(j in 1:3){
dfbetas[i, j] = (r.matrix[j, i] * (t[i] / sqrt(1 - h[i]))) / (sqrt(t(r.matrix[j, ]) %*% r.matrix[j, ]))
}
}
dfbetas = as.data.frame(dfbetas)
names(dfbetas) = c('intercept', 'cases', 'distances')
for(i in 1:25){
for(j in 1:3){
dfbetas[i, j] = (r.matrix[j, i] * (t[i] / sqrt(1 - h.diag[i]))) / (sqrt(t(r.matrix[j, ]) %*% r.matrix[j, ]))
}
}
dfbetas = as.data.frame(dfbetas)
names(dfbetas) = c('intercept', 'cases', 'distances')
table6.1 = bind_cols('d' = cooksdist, 'dffits' = dffits, dfbetas)
table6.1
setwd("C:/Users/karan/OneDrive/Documents/UVA/Fall Semester/SYS 6018/sys6018-competition-/sys6018-competition-blogger-characteristics/Other Models and Testing/karan/linear_svm")
library(readr)
library(dplyr)
py_output <- read_csv("test_sklearn_SVM_output.csv")
output_clean <- py_output %>% group_by(user.id) %>% summarise(Mean = mean(age))
write.table(output_clean, file = "blog_sklearn_SVM2.csv", row.names=F, col.names=c("user.id", "age"), sep=",")
library(readr)
library(dplyr)
py_output <- read_csv("test_sklearn_SVM_output.csv")
output_clean <- py_output %>% group_by(user.id) %>% summarise(Mean = mean(age))
output_clean$Mean<-floor(output_clean$Mean)
write.table(output_clean, file = "blog_sklearn_SVM2.csv", row.names=F, col.names=c("user.id", "age"), sep=",")
py_output <- read_csv("test_sklearn_SVM_output.csv")
output_clean <- py_output %>% group_by(user.id) %>% summarise(Mean = mean(age))
#output_clean$Mean<-floor(output_clean$Mean)
write.table(output_clean, file = "blog_sklearn_SVM2.csv", row.names=F, col.names=c("user.id", "age"), sep=",")
py_output <- read_csv("test_sklearn_SVM_output.csv")
output_clean <- py_output %>% group_by(user.id) %>% summarise(Mean = mean(age))
output_clean$Mean<-floor(output_clean$Mean)
write.table(output_clean, file = "blog_sklearn_SVM1.csv", row.names=F, col.names=c("user.id", "age"), sep=",")
